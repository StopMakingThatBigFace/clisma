---
title: "clisma.hcl"
description: "Define environments and migration settings in clisma.hcl"
icon: "file-pen"
---

Clisma uses an HCL config file to define environments and migration settings.

The root blocks are:

- `env "name"` for a database environment
- `variable "name"` for user-defined inputs

## Minimum config

```hcl
env "local" {
  url = "http://default:password@localhost:8123/mydb"

  migrations {
    dir = "migrations"
  }
}
```

## env "name"

```hcl

env "production" {
  url = "http://default:password@localhost:8123/mydb"
  cluster_name = "dwh"

  tls {
    ca_file = "certs/ca.pem"
  }

  migrations {
    dir = "migrations"
    table_name = "schema_migrations"
    replication_path = "/clickhouse/tables/{cluster}/schema_migrations"

    vars = {
      ttl_days = 30
    }
  }
}
```

Fields:

- `url` (string) Connection string. Supports `env("NAME")`.
- `cluster_name` (string, optional) Cluster name used for template context and replicated tracking. Required when your server has clusters configured.
- `exclude` (list\<string\>, optional) Patterns to ignore.
- `migrations` (block) Migration settings.
- `tls` (block, optional) TLS certificate settings for custom CA and mTLS:
  - `ca_file` (string, required if `tls` is set) Path to CA certificate in PEM format.
  - `cert_file` (string, optional) Client certificate in PEM format.
  - `key_file` (string, optional) Client key in PEM format. Must be provided together with `cert_file`.

## migrations

- `dir` (string) Path to migrations directory.
- `table_name` (string, optional) Custom tracking table.
- `replication_path` (string, optional) Replication path for the tracking table.
- `vars` (object, optional) Variables for Handlebars templates.

## variable "name"

```hcl
variable "ttl_days" {
  type = string
  default = "30"
  description = "Default TTL"
}
```
